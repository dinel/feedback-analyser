{% extends 'base.html.twig' %}

{% block stylesheets %}
    {{ parent() }}
    <style type="text/css">
    .popover{
        width:700px;
    }
    </style>
{% endblock stylesheets %}

{% block body %}
        
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script src="https://use.fontawesome.com/451e8f405a.js"></script>
<script>
    google.charts.load('current', {packages: ['corechart', 'bar']});
</script>

<div class="container">
    <div class="row header">
        <div class="col-md-8 col-md-offset-2 highlighted">
            <p class="text-right">
                {% if app.user %}
                    Hello {{ app.user }}!
                {% else %}
                    <a href="/login">Login</a>
                {% endif %}
            </p>
        </div>
    </div>

    <div class="row">
        <div class="col-md-2"
             ><h3>Activity</h3>
        </div>
        <div class="col-md-8 indented3">
            <strong>{{ activity.name }}</strong><br/>            
            <i>{{ activity.description }}</i> <br/><br>
            Date: {{ activity.date|date('d/m/Y') }}<br/>
            No feedbacks: {{ activity.feedbacks|length }}
        </div>
    </div>
    
<!-- Begin word cloud -->       
    <div class="row voffset4">
        <div class="col-md-2">
            <h3>Word cloud</h3>            
        </div>
        <div class="col-md-8">            
            {{ render_hinclude(controller(
                            'AppBundle:Default:getFrequencyList', 
                            {'id_activity': activity.id}), 
                            {'default': 'misc/wait.html.twig'}) 
            }}
            <div class="text-right">
                <a data-toggle="popover" title="About word clouds" 
                   data-content="This word cloud shows the 40 most frequent words 
                   mentioned by participants. Stop words such as 'the' and 'and' 
                   were removed. We removed also 'university' and 'day'. Click on 
                   the word if you want to see the context in which it is used. ">
                    <i class="fa fa-question-circle-o fa-2x" aria-hidden="true"></i>
                </a>
            </div>
            <div id="keywords"></div>
        </div>
    </div>            
<!-- End word cloud -->

<!-- Begin Tone analysis -->
    <div class="row voffset4">
        <div class="col-md-2">
            <h3>Tone analysis</h3>
         </div>
        <div class="col-md-8">
            <div class="text-right">
                <a data-toggle="popover" title="About tone analysis"
                   data-content="Uses linguistic analysis to detect three types 
                   of tones from text: emotion, social tendencies, and language style.
                   Tone analysis is different from sentiment analysis because 
                   tone analysis is less about analyzing how someone else feels, 
                   and more about analyzing how they are coming across to others.
                   The tone anaysis is powered by Watson Tone Analyzer Service 
                   (https://www.ibm.com/watson/
                   developercloud/doc/tone-analyzer/)">
                    <i class="fa fa-question-circle-o fa-2x" aria-hidden="true"></i>
                </a>
            </div>
        </div>
    </div>

<!-- Begin emotion -->
    <div class="row voffset2">
        <div class="col-md-2">
            <h4>Emotion</h4>
         </div>
        <div class="col-md-8">
            <div class="text-right">
                <a data-toggle="popover" title="Anger"
                   data-content="Evoked due to injustice, 
                   conflict, humiliation, negligence or betrayal. If anger 
                   is active, the individual attacks the target, verbally or 
                   physically. If anger is passive, the person silently sulks 
                   and feels tension and hostility. Values over 0.75 are more
                   likely to be perceived as angry.">
                    <i class="fa fa-question-circle-o fa-2x" aria-hidden="true"></i>
                </a>
            </div>            
            {% include 'analysis/tone_graph.html.twig' with {'key':'Anger', 'stat':statistics['Anger']} %}
        </div>
    </div>

    <div class="row voffset2">
        <div class="col-md-8 col-md-offset-2">
            <div class="text-right">
                <a data-toggle="popover" title="Disgust"
                   data-content="An emotional response of 
                   revulsion to something considered offensive or unpleasant. It 
                   is a sensation that refers to something revolting. Values over 
                   0.75 are more likely to be perceived as disgusted.">
                    <i class="fa fa-question-circle-o fa-2x" aria-hidden="true"></i>
                </a>
            </div>            
            {% include 'analysis/tone_graph.html.twig' with {'key':'Disgust', 'stat':statistics['Disgust']} %}
        </div>
    </div>
        
    <div class="row voffset2">
        <div class="col-md-8 col-md-offset-2">
            <div class="text-right">
                <a data-toggle="popover" title="Fear"
                   data-content="A response to impending danger. It is a survival 
                   mechanism that is a reaction to some negative stimulus. It may 
                   be a mild caution or an extreme phobia. Values over 
                   0.75 are more likely to be perceived as scared.">
                    <i class="fa fa-question-circle-o fa-2x" aria-hidden="true"></i>
                </a>
            </div>            
            {% include 'analysis/tone_graph.html.twig' with {'key':'Fear', 'stat':statistics['Fear']} %}
        </div>
    </div>
        
    <div class="row voffset2">
        <div class="col-md-8 col-md-offset-2">
            <div class="text-right">
                <a data-toggle="popover" title="Joy"
                   data-content="Joy or happiness has shades of enjoyment, 
                   satisfaction and pleasure. There is a sense of well-being, 
                   inner peace, love, safety and contentment. Higher values 
                   indicate more joyful.">
                    <i class="fa fa-question-circle-o fa-2x" aria-hidden="true"></i>
                </a>
            </div>            
            {% include 'analysis/tone_graph.html.twig' with {'key':'Joy', 'stat':statistics['Joy']} %}
        </div>
    </div>
        
    <div class="row voffset2">
        <div class="col-md-8 col-md-offset-2">
            <div class="text-right">
                <a href="#" data-toggle="popover" title="Sadness"
                   data-content="Indicates a feeling of loss and disadvantage. When 
                   a person can be observed to be quiet, less energetic and withdrawn, 
                   it may be inferred that sadness exists. Values over 0.75 are more
                   likely to be perceived as sad.">
                    <i class="fa fa-question-circle-o fa-2x" aria-hidden="true"></i>
                </a>
            </div>            
            {% include 'analysis/tone_graph.html.twig' with {'key':'Sadness', 'stat':statistics['Sadness']} %}
        </div>
    </div>
<!-- End emotion -->

<!-- Beging social tone -->    
    <div class="row voffset2">
        <div class="col-md-2">
            <h4>Social tone</h4>
         </div>
        <div class="col-md-8">
            <div class="text-right">
                <a data-toggle="popover" title="Social tone"
                   data-content="Social tone measures the social tendencies in 
                   people's writing. Tone Analyzer responds with analysis on 
                   five different social tones: openness, conscientiousness, 
                   extraversion, agreeableness, and emotional range (or neuroticism). 
                   These five social tones are adopted from the Big-five personality 
                   model.">
                    <i class="fa fa-question-circle-o fa-2x" aria-hidden="true"></i>
                </a>
            </div>                        
        </div>
    </div>

    <div class="row voffset2">
        <div class="col-md-8 col-md-offset-2">
            <div class="text-right">
                <a data-toggle="popover" title="Openness"
                   data-content="The extent a person is open to experience a variety 
                   of activities. 
                   Value over 0.75 more likely to be perceived as 
                   as intellectual, curious, emotionally-aware, imaginative, willing 
                   to try new things, appreciating beauty, or open to change.">
                   <i class="fa fa-question-circle-o fa-2x" aria-hidden="true"></i>
                </a>
            </div>            
            {% include 'analysis/tone_graph.html.twig' with {'key':'Openness', 'stat':statistics['Openness']} %}
        </div>
    </div>

    <div class="row voffset2">
        <div class="col-md-8 col-md-offset-2">
            <div class="text-right">
                <a data-toggle="popover" title="Conscientiousness"
                   data-content="The tendency to act in an organized or thoughtful way. 
                   Value over 0.75 more likely to be perceived as 
                   perceived as disciplined, dutiful, achievement-striving, confident, 
                   driven, or organized.">
                   <i class="fa fa-question-circle-o fa-2x" aria-hidden="true"></i>
                </a>
            </div>            
            {% include 'analysis/tone_graph.html.twig' with {'key':'Conscientiousness', 'stat':statistics['Conscientiousness']} %}
        </div>
    </div>
        
    <div class="row voffset2">
        <div class="col-md-8 col-md-offset-2">
            <div class="text-right">
                <a data-toggle="popover" title="Extraversion"
                   data-content="The tendency to seek stimulation in the company of 
                   others. Value over 0.75 more likely to be perceived as 
                    as engaging, seeking attention, needy, assertive, outgoing, 
                    sociable, cheerful, excitement-seeking, or busy.">
                   <i class="fa fa-question-circle-o fa-2x" aria-hidden="true"></i>
                </a>
            </div>            
            {% include 'analysis/tone_graph.html.twig' with {'key':'Extraversion', 'stat':statistics['Extraversion']} %}
        </div>
    </div>
        
        
    <div class="row voffset2">
        <div class="col-md-8 col-md-offset-2">
            <div class="text-right">
                <a data-toggle="popover" title="Agreeableness"
                   data-content="The tendency to be compassionate and cooperative towards others.">
                   <i class="fa fa-question-circle-o fa-2x" aria-hidden="true"></i>
                </a>
            </div>            
            {% include 'analysis/tone_graph.html.twig' with {'key':'Agreeableness', 'stat':statistics['Agreeableness']} %}
        </div>
    </div>
        
        
    <div class="row voffset2">
        <div class="col-md-8 col-md-offset-2">
            <div class="text-right">
                <a data-toggle="popover" title="Emotional range"
                   data-content="The extent a person's emotion is sensitive to 
                   the environment. Value over 0.75 more likely to be perceived as 
                   concerned, frustrated, angry, passionate, upset, stressed, insecure, 
                   or impulsive.">
                   <i class="fa fa-question-circle-o fa-2x" aria-hidden="true"></i>
                </a>
            </div>
            
            {% include 'analysis/tone_graph.html.twig' with {'key':'Emotional Range', 'stat':statistics['Emotional Range']} %}
        </div>
    </div>
<!-- End social tone -->

<!-- Begin language tone -->
    <div class="row voffset2">
        <div class="col-md-2">
            <h4>Language tone</h4>
         </div>
        <div class="col-md-8">
            <div class="text-right">
                <a data-toggle="popover" title="Language tone"
                   data-content="Describes perceived writing style using these 
                   categories: analytical style, reasoning style, and confidence. 
                   For each of these categories, the service outputs a score from 0 to 1">
                    <i class="fa fa-question-circle-o fa-2x" aria-hidden="true"></i>
                </a>
            </div>                        
        </div>
    </div>

    <div class="row voffset2">
        <div class="col-md-8 col-md-offset-2">
            <div class="text-right">
                <a data-toggle="popover" title="Analytical"
                   data-content="A person's reasoning and analytical attitude about things.
                   Value over 0.75 more likely to be perceived as 
                   as  intellectual, rational, systematic, emotionless, or impersonal.">
                   <i class="fa fa-question-circle-o fa-2x" aria-hidden="true"></i>
                </a>
            </div>            
            {% include 'analysis/tone_graph.html.twig' with {'key':'Analytical', 'stat':statistics['Analytical']} %}
        </div>
    </div>

    <div class="row voffset2">
        <div class="col-md-8 col-md-offset-2">
            <div class="text-right">
                <a data-toggle="popover" title="Confident"
                   data-content="A persons degree of certainty. 
                   Value over 0.75 more likely to be perceived as 
                   assured, collected, hopeful, or egotistical.">
                   <i class="fa fa-question-circle-o fa-2x" aria-hidden="true"></i>
                </a>
            </div>            
            {% include 'analysis/tone_graph.html.twig' with {'key':'Confident', 'stat':statistics['Confident']} %}
        </div>
    </div>
        
    <div class="row voffset2">
        <div class="col-md-8 col-md-offset-2">          
            {% include 'analysis/tone_graph.html.twig' with {'key':'Tentative', 'stat':statistics['Tentative']} %}
            <a data-toggle="popover" title="Tentative"
                   data-content="A persons degree of inhibition.
                   Value over 0.75 more likely to be perceived as 
                   questionable, doubtful, limited, or debatable.">
                   <i class="fa fa-question-circle-o fa-2x" aria-hidden="true"></i>
                </a>
        </div>
    </div>
            
<!-- End language tone -->

{% for key,stat in statistics %}
<script>
    google.charts.setOnLoadCallback(drawChart{{key|replace(' ','_')}});

    function drawChart{{key|replace(' ','_')}}() {
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Tone');
        data.addColumn('number', '');

        data.addRows([
           ['Min', {{stat[2]}}],
           ['Average', {{stat[0]/stat[1]}}],
           ['Max', {{stat[3]}}],
        ]);


        var options = {'title':'{{key}}',
                   'width':350,
                   'height':300,
                   legend: {position: 'none'}
               };

        var chart = new google.visualization.ColumnChart(document.getElementById('chart_div_{{key|replace(' ','_')}}'));
        chart.draw(data, options);
    }
    </script>
                    
    <div style="display: inline-block" id="chart_div_{{key|replace(' ','_')}}"></div>
{% endfor %}
                
        </div>
    </div>
</div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        $(document).ready(function(){
            $('[data-toggle="popover"]').popover();
        });
    </script>
    <script src="{{ asset('assets/vendor/jqcloud2/dist/jqcloud.min.js') }}"></script>
    <script src="{{ asset('js/hinclude.js') }}"></script>
{% endblock %}